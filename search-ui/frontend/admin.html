<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Kleine Anfragen</title>
    <link rel="stylesheet" href="/static/css/admin.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Login Modal -->
    <div class="login-overlay" id="login-overlay">
        <div class="login-modal">
            <div class="login-header">
                <svg class="login-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                </svg>
                <h2>Admin Login</h2>
            </div>
            <form id="login-form" class="login-form">
                <div class="form-group">
                    <label for="username">Benutzername</label>
                    <input type="text" id="username" name="username" required autocomplete="username">
                </div>
                <div class="form-group">
                    <label for="password">Passwort</label>
                    <input type="password" id="password" name="password" required autocomplete="current-password">
                </div>
                <div class="login-error" id="login-error"></div>
                <button type="submit" class="login-button">Anmelden</button>
            </form>
        </div>
    </div>

    <!-- Main App -->
    <div class="admin-app" id="admin-app" style="display: none;">
        <!-- Header -->
        <header class="admin-header">
            <div class="header-left">
                <a href="/" class="back-link">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="19" y1="12" x2="5" y2="12"/>
                        <polyline points="12 19 5 12 12 5"/>
                    </svg>
                    Zurueck zur Suche
                </a>
                <h1>Admin Dashboard</h1>
            </div>
            <div class="header-right">
                <span class="admin-user" id="admin-user"></span>
                <button class="logout-button" id="logout-button">Abmelden</button>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="admin-nav">
            <button class="nav-tab active" data-tab="overview">Uebersicht</button>
            <button class="nav-tab" data-tab="vorgaenge">Vorgaenge</button>
            <button class="nav-tab" data-tab="drucksachen">Drucksachen</button>
            <button class="nav-tab" data-tab="sql">SQL Query</button>
        </nav>

        <!-- Content -->
        <main class="admin-content">
            <!-- Overview Tab -->
            <section class="tab-content active" id="tab-overview">
                <div class="stats-grid" id="stats-grid">
                    <!-- Stats loaded dynamically -->
                </div>

                <div class="charts-grid">
                    <div class="chart-card">
                        <h3>Nach Ressort</h3>
                        <div class="bar-chart" id="chart-ressort"></div>
                    </div>
                    <div class="chart-card">
                        <h3>Nach Status</h3>
                        <div class="bar-chart" id="chart-status"></div>
                    </div>
                    <div class="chart-card">
                        <h3>Nach Jahr</h3>
                        <div class="bar-chart" id="chart-year"></div>
                    </div>
                    <div class="chart-card">
                        <h3>Drucksache Typen</h3>
                        <div class="bar-chart" id="chart-types"></div>
                    </div>
                </div>

                <div class="recent-section">
                    <h3>Zuletzt aktualisiert</h3>
                    <table class="data-table" id="recent-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Titel</th>
                                <th>Datum</th>
                                <th>Aktualisiert</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Vorgaenge Tab -->
            <section class="tab-content" id="tab-vorgaenge">
                <div class="toolbar">
                    <input type="text" id="vorgang-search" class="search-input" placeholder="Suchen...">
                    <select id="vorgang-ressort" class="filter-select">
                        <option value="">Alle Ressorts</option>
                    </select>
                    <select id="vorgang-status" class="filter-select">
                        <option value="">Alle Status</option>
                    </select>
                </div>

                <div class="table-container">
                    <table class="data-table" id="vorgaenge-table">
                        <thead>
                            <tr>
                                <th class="sortable" data-sort="vorgang_id">ID</th>
                                <th class="sortable" data-sort="titel">Titel</th>
                                <th class="sortable" data-sort="datum">Datum</th>
                                <th class="sortable" data-sort="ressort">Ressort</th>
                                <th class="sortable" data-sort="beratungsstand">Status</th>
                                <th>Embedding</th>
                                <th>Aktionen</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <div class="pagination" id="vorgaenge-pagination"></div>
            </section>

            <!-- Drucksachen Tab -->
            <section class="tab-content" id="tab-drucksachen">
                <div class="toolbar">
                    <input type="text" id="drucksache-vorgang" class="search-input" placeholder="Vorgang ID filtern...">
                </div>

                <div class="table-container">
                    <table class="data-table" id="drucksachen-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Vorgang ID</th>
                                <th>Titel</th>
                                <th>Typ</th>
                                <th>Nummer</th>
                                <th>Datum</th>
                                <th>Text</th>
                                <th>Aktionen</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <div class="pagination" id="drucksachen-pagination"></div>
            </section>

            <!-- SQL Tab -->
            <section class="tab-content" id="tab-sql">
                <div class="sql-editor">
                    <label for="sql-input">SQL Query (nur SELECT)</label>
                    <textarea id="sql-input" placeholder="SELECT * FROM vorgang LIMIT 10"></textarea>
                    <button id="sql-execute" class="execute-button">Ausfuehren</button>
                </div>

                <div class="sql-result" id="sql-result">
                    <p class="sql-hint">Verfuegbare Tabellen: <code>vorgang</code>, <code>drucksache</code>, <code>drucksache_text</code></p>
                </div>
            </section>
        </main>
    </div>

    <!-- Text Modal -->
    <div class="modal-overlay" id="text-modal-overlay">
        <div class="modal text-modal">
            <div class="modal-header">
                <h3 id="text-modal-title">Volltext</h3>
                <button class="modal-close" id="text-modal-close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" id="text-modal-body">
                <pre id="text-modal-content"></pre>
            </div>
        </div>
    </div>

    <script src="/static/js/admin.js"></script>
</body>
</html>
